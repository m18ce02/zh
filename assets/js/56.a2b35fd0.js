(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{386:function(t,s,a){"use strict";a.r(s);var r=a(8),e=Object(r.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[s("code",[t._v("版本: 1.2 | 发布日期: 07/02/2024")])]),t._v(" "),s("h2",{attrs:{id:"引言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#引言"}},[t._v("#")]),t._v(" 引言")]),t._v(" "),s("p",[t._v("在任何现代交易系统中，修改数据总是不可避免的。")]),t._v(" "),s("p",[t._v("提供灵活的编辑环境对于增强用户体验至关重要。")]),t._v(" "),s("h2",{attrs:{id:"目的"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#目的"}},[t._v("#")]),t._v(" 目的")]),t._v(" "),s("p",[t._v("阅读本章后，你应该能够:")]),t._v(" "),s("ol",[s("li",[t._v("读取模块单据")]),t._v(" "),s("li",[t._v("更新模块单据")])]),t._v(" "),s("h2",{attrs:{id:"场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#场景"}},[t._v("#")]),t._v(" 场景")]),t._v(" "),s("p",[t._v("Chris 的 ABC 水果公司网上商店经营得很好。")]),t._v(" "),s("p",[t._v("在客户需要更改订单时，他希望能够改善用户体验。")]),t._v(" "),s("p",[t._v("客户要求取消订单时必须致电 Chris，以便更正订单内容。")]),t._v(" "),s("p",[t._v("Chris 希望在网上商店中实现编辑功能。")]),t._v(" "),s("p",[t._v("Chris 设计了如下布局，用户可以通过点击不同的 "),s("code",[t._v("订单编号")]),t._v("来查看销售订单的详细信息。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/zh/assets/wst18.png",alt:"wst18"}})]),t._v(" "),s("p",[t._v("根据以往的经验，Chris 可以使用"),s("RouterLink",{attrs:{to:"/pages/1589cf/"}},[t._v("搜索服务")]),t._v("列出"),s("code",[t._v("已保存的订单列表")]),t._v("。")],1),t._v(" "),s("p",[t._v("但如何显示订单的产品信息呢？")]),t._v(" "),s("p",[t._v("为了实现这一目标，我们需要调用 "),s("RouterLink",{attrs:{to:"/pages/c79a4a/#read-entity"}},[t._v("读取实体服务")]),t._v("。")],1),t._v(" "),s("h2",{attrs:{id:"读取模块单据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#读取模块单据"}},[t._v("#")]),t._v(" 读取模块单据")]),t._v(" "),s("p",[s("strong",[t._v("HTTP 请求")])]),t._v(" "),s("p",[s("code",[t._v("GET http://[server]/jsf/rfws/entity/read/[module]?menuCode=[menuCode]&id=[id]")])]),t._v(" "),s("p",[s("strong",[t._v("参数")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("名字")]),t._v(" "),s("th",[t._v("类型")]),t._v(" "),s("th",[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("authorization")]),t._v(" "),s("td",[s("code",[t._v("String")]),t._v("("),s("em",[t._v("Header")]),t._v(")")]),t._v(" "),s("td",[s("strong",[t._v("必填.")]),t._v(" "),s("RouterLink",{attrs:{to:"/pages/b24673/"}},[t._v("通过 OAuth 获取")]),t._v("的访问令牌")],1)]),t._v(" "),s("tr",[s("td",[t._v("client_id")]),t._v(" "),s("td",[s("code",[t._v("String")]),t._v("("),s("em",[t._v("Header")]),t._v(")")]),t._v(" "),s("td",[s("strong",[t._v("必填.")]),t._v(" aiM18 "),s("RouterLink",{attrs:{to:"/pages/b24673/"}},[t._v("授权应用列表")]),t._v("中的Client ID")],1)]),t._v(" "),s("tr",[s("td",[t._v("module")]),t._v(" "),s("td",[s("code",[t._v("String")]),t._v("("),s("em",[t._v("Path")]),t._v(")")]),t._v(" "),s("td",[s("strong",[t._v("必填.")]),t._v(" 模块类型，例如‘员工’，可以在数据字典中找到")])]),t._v(" "),s("tr",[s("td",[t._v("menuCode")]),t._v(" "),s("td",[s("code",[t._v("String")]),t._v("("),s("em",[t._v("Query")]),t._v(")")]),t._v(" "),s("td",[s("strong",[t._v("必填.")]),t._v(" 菜单编号，例如‘员工’，可以在数据字典中找到")])]),t._v(" "),s("tr",[s("td",[t._v("id")]),t._v(" "),s("td",[s("code",[t._v("long")]),t._v("("),s("em",[t._v("Query")]),t._v(")")]),t._v(" "),s("td",[s("strong",[t._v("必填.")]),t._v(" 实体ID")])]),t._v(" "),s("tr",[s("td",[t._v("param")]),t._v(" "),s("td",[s("code",[t._v("json String")]),t._v("("),s("em",[t._v("Query")]),t._v(")")]),t._v(" "),s("td",[t._v("特殊操作的附加参数")])]),t._v(" "),s("tr",[s("td",[t._v("iRev")]),t._v(" "),s("td",[s("code",[t._v("int")]),t._v("("),s("em",[t._v("Query")]),t._v(")")]),t._v(" "),s("td",[t._v("如果要读取实体的旧版本，请设置此值。如果要读取已删除实体，请设置已删除实体的 "),s("code",[t._v("id")]),t._v(" 和 "),s("code",[t._v("iRev")]),t._v("。")])])])]),t._v(" "),s("p",[t._v("该服务有三个必需参数，分别是"),s("code",[t._v("module")]),t._v("，"),s("code",[t._v("menuCode")]),t._v("和"),s("code",[t._v("id")]),t._v("。")]),t._v(" "),s("p",[t._v("对于 "),s("code",[t._v("id")]),t._v(" 参数，请参考"),s("RouterLink",{attrs:{to:"/pages/c79a4a/#get-id-by-code-web-service"}},[t._v("通过编号获取 Id Web 服务")]),t._v("或"),s("RouterLink",{attrs:{to:"/pages/1589cf/"}},[t._v("搜索数据")]),t._v("。")],1),t._v(" "),s("p",[t._v("在这种场景下，"),s("code",[t._v("id")]),t._v("应包含在用于显示销售订单列表的搜索响应中。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/zh/assets/wst19.png",alt:"wst19"}})]),t._v(" "),s("p",[s("strong",[t._v("获取 Id = 2 的销售订单信息的请求示例")])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GET")]),t._v("\nhttp"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("server"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("jsf"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("rfws"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("entity"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("read"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("oldso"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("menuCode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("oldso"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n")])])]),s("p",[s("strong",[t._v("响应示例")])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"mainso"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v('"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"size"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"values"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n\t\t   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"iRev"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"code"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SO002"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ...\n\t\t   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"sot"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v('"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"size"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"values"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n\t\t   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hId"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"itemNo"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"     1, "')]),t._v("proId"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('": 3, "')]),t._v("bDesc"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('":"')]),t._v("Peach"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('", "')]),t._v('qty"'),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ...\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hId"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"itemNo"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"     2, "')]),t._v("proId"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('": 1, "')]),t._v("bDesc"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('":"')]),t._v("Apple"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('", "')]),t._v('qty"'),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("21.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ...\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hId"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"itemNo"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"     3, "')]),t._v("proId"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('": 4, "')]),t._v("bDesc"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('":"')]),t._v("Orange"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('", "')]),t._v('qty"'),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ...\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hId"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"itemNo"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"     4, "')]),t._v("proId"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('": 1, "')]),t._v("bDesc"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('":"')]),t._v("Apple"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('", "')]),t._v('qty"'),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ...\n\t\t   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("读取现有订单并不是结束。当客户更改内容时，我们需要更新订单。")]),t._v(" "),s("p",[t._v("我们通过调用"),s("RouterLink",{attrs:{to:"/pages/c79a4a/#save-entity"}},[t._v("保存实体服务")]),t._v("来实现这一点。")],1),t._v(" "),s("h2",{attrs:{id:"更新模块单据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#更新模块单据"}},[t._v("#")]),t._v(" 更新模块单据")]),t._v(" "),s("p",[s("code",[t._v("保存实体服务")]),t._v("能够执行两项功能，首先创建模块单据，其次更新已经存在的模块单据。")]),t._v(" "),s("p",[t._v("关于模块单据的创建，前面我们已经有完整的例子，请参考"),s("RouterLink",{attrs:{to:"/pages/2680cf/"}},[t._v("创建模块数据")]),t._v("。")],1),t._v(" "),s("p",[t._v("那么系统如何判断该调用是添加还是修改模块单据呢？")]),t._v(" "),s("p",[t._v("答案是"),s("code",[t._v("id")]),t._v("。")]),t._v(" "),s("p",[t._v("系统将检查请求是否包含 "),s("code",[t._v("id")]),t._v(" 信息，以及 "),s("code",[t._v("id")]),t._v(" 信息是否与数据库中的记录相对应。")]),t._v(" "),s("h2",{attrs:{id:"最佳做法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#最佳做法"}},[t._v("#")]),t._v(" 最佳做法")]),t._v(" "),s("p",[t._v("每次要修改一个已经存在的模块单据时，都要先读取它，然后直接在 SqlEntity 中修改它，然后调用 "),s("RouterLink",{attrs:{to:"/pages/c79a4a/#save-entity"}},[t._v("保存实体服务")]),t._v(" 保存它。")],1),t._v(" "),s("h2",{attrs:{id:"faq"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#faq"}},[t._v("#")]),t._v(" FAQ")]),t._v(" "),s("p",[t._v("1.是否有其他方法来确定该保存操作是创建新记录还是修改现有记录？")]),t._v(" "),s("p",[t._v("对于ERP相关的应用程序接口，答案是肯定的。")]),t._v(" "),s("p",[s("code",[t._v("code")]),t._v("是 aiM18 记录中的另一个重要字段。将此字段指定为唯一的用户可确保"),s("code",[t._v("code")]),t._v("不会重复。")]),t._v(" "),s("p",[t._v("存储具有相同"),s("code",[t._v("code")]),t._v("的记录将被视为更新。")])])}),[],!1,null,null,null);s.default=e.exports}}]);